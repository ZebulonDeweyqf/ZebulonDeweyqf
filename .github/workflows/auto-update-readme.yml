name: è‡ªåŠ¨æ›´æ–° README + æ¯æ—¥ä¸€å¥ + æœç´¢å¼•æ“ Ping

on:
  schedule:
    - cron: '0 2 * * *'  # æ¯æ—¥ UTC 02:00ï¼Œå¯¹åº”åŒ—äº¬æ—¶é—´ 10:00
  workflow_dispatch:     # æ‰‹åŠ¨è§¦å‘

jobs:
  update-readme:
    runs-on: ubuntu-latest

    steps:
      - name: æ£€å‡ºä»“åº“ä»£ç 
        uses: actions/checkout@v4

      - name: è®¾ç½® Git ç”¨æˆ·ä¿¡æ¯
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "41898282+github-actions[bot]@users.noreply.github.com"

      - name: è·å–æ¯æ—¥ä¸€å¥ï¼ˆå†…ç½®éšæœºåè¨€ï¼‰
        id: quote
        run: |
          QUOTES=(
            "â€œStay hungry, stay foolish.â€ â€” Steve Jobs"
            "â€œSimplicity is the soul of efficiency.â€ â€” Austin Freeman"
            "â€œDo not go where the path may lead, go instead where there is no path and leave a trail.â€ â€” Ralph Waldo Emerson"
            "â€œä»£ç æ°¸è¿œä¸ä¼šè¯´è°ï¼Œä½†ä½ å¯èƒ½çœ‹é”™äº†ã€‚â€"
            "â€œTalk is cheap. Show me the code.â€ â€” Linus Torvalds"
            "â€œæƒ³å¾—å¤ªå¤šï¼Œä¸å¦‚å†™ä»£ç ã€‚â€"
            "â€œäººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨ Pythonã€‚â€"
          )
          SELECTED="${QUOTES[$((RANDOM % ${#QUOTES[@]}))]}"
          echo "QUOTE=$SELECTED" >> $GITHUB_ENV

      - name: è¿½åŠ æ›´æ–°æ—¶é—´ä¸æ¯æ—¥ä¸€å¥
        run: |
          cp README.md README.temp.md

          echo "" >> README.temp.md
          echo "---" >> README.temp.md
          echo "âœ… æ­¤æ–‡ä»¶æœ€è¿‘ä¸€æ¬¡è‡ªåŠ¨æ›´æ–°ï¼š" >> README.temp.md
          echo "- ğŸ•’ UTC æ—¶é—´ï¼š$(date -u '+%Y-%m-%d %H:%M:%S')" >> README.temp.md
          echo "- ğŸ•™ åŒ—äº¬æ—¶é—´ï¼š$(TZ='Asia/Shanghai' date '+%Y-%m-%d %H:%M:%S')" >> README.temp.md
          echo "" >> README.temp.md
          echo "ğŸ“œ æ¯æ—¥ä¸€å¥ï¼š" >> README.temp.md
          echo "> ${QUOTE}" >> README.temp.md
          echo "" >> README.temp.md
          echo "âœ¨ æœ¬æ›´æ–°ç”± GitHub Actions è‡ªåŠ¨æ‰§è¡Œï¼Œå·²é€šçŸ¥æœç´¢å¼•æ“ã€‚" >> README.temp.md

          if ! cmp -s README.md README.temp.md; then
            mv README.temp.md README.md
            git add README.md
            git commit -m "ğŸ¤– è‡ªåŠ¨æ›´æ–° READMEï¼ˆæ¯æ—¥ä¸€å¥ + æ—¶é—´æˆ³ï¼‰"
            git push
          else
            echo "README æ— å˜åŒ–ï¼Œæ— éœ€æäº¤ã€‚"
          fi

      - name: Ping Google å’Œ Bing
        run: |
          TARGET_URL="https://github.com/ZebulonDeweyqf/ZebulonDeweyqf"

          echo "ğŸ”” Ping Google"
          curl -s "http://www.google.com/ping?sitemap=${TARGET_URL}" || echo "Google ping å¤±è´¥"

          echo "ğŸ”” Ping Bing"
          curl -s "https://www.bing.com/ping?sitemap=${TARGET_URL}" || echo "Bing ping å¤±è´¥"
